# automation for managing firefox profiles with extensions
# commands:
# * firefox-profile-list
# * firefox-profile-create new-name-of-profile
# * firefox-profile-start new-name-of-profile
#
FIREFOX_HOME=$HOME/.mozilla/firefox

function firefox-profile-list(){
    echo "-----"
    ls $FIREFOX_PROFILES_DIR | grep "profile-"
    echo "-----"
}

function firefox-profile-start(){
    if [[ $1 == "" ]]; then
        echo "specify profile"
        return;
    fi
    PROFILE_DIR=$FIREFOX_PROFILES_DIR/"profile-"$1
    if [[ -e $PROFILE_DIR ]]; then
        firefox --profile $PROFILE_DIR --no-first-run --no-default-browser-check &
    else
        echo "profile $PROFILE_DIR does not exist"
    fi
}

function firefox-profile-create(){
    if [[ $1 == "" ]]; then
        echo "specify profile name"
        return;
    fi
    PROFILE_NEW_NAME="profile-"$1
    PROFILE_DIR=$FIREFOX_PROFILES_DIR"/"$PROFILE_NEW_NAME
    if [[ -e $PROFILE_DIR ]]; then
        echo "profile $PROFILE_DIR exist !!! "
        return;
    fi

    # print info
    echo ">>>"$PROFILE_NEW_NAME
    echo $PROFILE_DIR

    # extensions creation
    PROFILE_EXTENSION_DIR=$PROFILE_DIR/extensions
    mkdir -p $PROFILE_EXTENSION_DIR
    for each_extension in "${FIREFOX_EXTENSIONS[@]}"; do
        echo "copy extensions: $FIREFOX_EXTENSION_ORIGINAL_DIR/$each_extension --> $PROFILE_EXTENSION_DIR/$each_extension"
        cp $FIREFOX_EXTENSION_ORIGINAL_DIR/$each_extension $PROFILE_EXTENSION_DIR/$each_extension
    done;

    # open firefox 
    firefox --profile $PROFILE_DIR --no-default-browser-check &
}

