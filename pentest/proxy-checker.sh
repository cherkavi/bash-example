# https://free-proxy-list.net/
# https://openproxy.space/list
# http://free-proxy.cz/en/
# https://www.proxynova.com/proxy-server-list
# https://www.proxy-list.download/HTTP
# https://spys.one/free-proxy-list/UA/
# https://www.sslproxies.org/
# http://www.freeproxylists.net/
# https://proxyscrape.com/free-proxy-list

# expected file should contains lines like:
# 92.244.99.229:3128

if [[ $1 == "" ]]
then
	echo "first argument must be a path to file"
	exit 1
fi

cat $1 | while read proxy_uri
do
    export http_proxy="$proxy_uri"
    export https_proxy="$proxy_uri"
    curl_time=$(curl --max-time 10 -so /dev/null -w '%{time_total}\n' google.com)
    result_code=$(echo $?)
    if [ $result_code == 0 ]; then
        echo "$result_code $curl_time  $proxy_uri"
    fi    
done
